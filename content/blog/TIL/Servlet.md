---
title: 'Servlet'
date: 2021-01-09 20:25:00
category: 'TIL'
draft: false
---
## 1. Servlet이란?
자바를 사용하여 웹페이지를 동적으로 생성하는 서버측 프로그램 혹은 그 사양
즉, 클라이언트의 요청을 처리하고 그 결과를 다시 클라이언트에게 전송하는 Servlet 클래스의 구현 규칙을 지킨 자바 프로그램

## 2. Common Gateway Interface란?
웹서버와 외부 프로그램 사이에서 정보를 주고받는 방법이나 규약들을 말한다.
CGI는 요청이 있을 때마다 새로운 프로세스가 생성되어 응답하는 데 비해, 자바 서블릿은 외부 요청마다 프로세스보다 가벼운 스레드로써 응답하므로 보다 가볍다.

## 3. Web Server란
하드웨어 측면에서 Web Server는 web site의 컴포넌트 파일들을 저장하는 컴퓨터이다. 웹 서버는 인터넷에 연결되어 웹에 연결된 다른 기기들이 Web Server의 데이터를 주고 받을 수 있게 한다.
소프트웨어 측면에서 Web Server는 웹 사용자가 어떻게 호스트 파일들에 접근하는지를 관리한다.

브라우저가 Web Server에 있는 파일을 필요로 할때, 브라우저는 HTTP를 통해 파일을 요청한다.
요청이 올바른 Web Server(하드웨어)에 도달하였을 때, HTTP 서버(software)는 요청된 문서를 HTTP를 이용해 보내준다.

※ HTTP 서버는 URL(Web address)과 HTTP(라우저가 웹 페이지를 보여주기 위해 사용하는 프로토콜)의 소프트웨어 일부이다.

Web Server = 정적 Web Server + 동적 Web Server

- 정적 Web Server

서버에 저장된 파일들을 브라우저에게 전송

서버에 저장된 데이터가 변경되지 않는 한 바뀌지 않으므로 정적이라 표현한다.

- 동적 Web Server = 정적 Web Server + Application Server, Database

WAS는 웹 서버로부터 요청을 받아서 처리하며, 그 결과를 웹 서버로 반환한다.

주로 동적인 페이지 생성을 위한 데이터베이스 연동 등의 작업을 하게 된다.

## 4.  Servlet Container
Servlet을 관리(생성,실행,파괴)하는 컨테이너

### Servlet Container 역할
- 웹서버와의 통신 지원
   
   서블릿 컨테이너는 서블릿과 웹서버가 손쉽게 통신할 수 있게 해준다. 일반적으로 소켓을 만들고 listen, accept 등을 해야하지만 서블릿 컨테이너는 이러한 기능을 API로 제공하여 복잡한 과정을 생략할 수 있게 해준다. 그래서 개발자가 서블릿에 구현해야 할 비지니스 로직에 대해서만 초점을 두게끔 도와준다.
  

- 서블릿 생명주기 관리 
   
   서블릿 컨테이너는 서블릿 클래스를 로딩하여 인스턴스화하고, 초기화 메소드를 호출하고, 요청이 들어오면 적절한 서블릿 메소드를 호출한다. 또한 수명이 다 된 서블릿을 적절하게 가비지 콜렉터를 호출하여 필요없는 자원 낭비를 막아준다.


- 멀티쓰레드 지원 및 관리 
   
   서블릿 컨테이너는 Request가 올 때마다 새로운 자바 쓰레드를 하나 생성하는데, HTTP 서비스 메소드를 실행하고 나면, 쓰레드는 자동으로 죽게 된다. 원래는 쓰레드를 관리해야 하지만 서버가 다중 쓰레드를 생성 및 운영해주니 쓰레드의 안정성에 대해서 걱정하지 않아도 된다.


- 선언적인 보안 관리 
   
   서블릿 컨테이너를 사용하면 개발자는 보안에 관련된 내용을 서블릿 또는 자바 클래스에 구현해 놓지 않아도 된다. 일반적으로 보안관리는 XML 배포 서술자에다가 기록하므로, 보안에 대해 수정할 일이 생겨도 자바 소스 코드를 수정하여 다시 컴파일 하지 않아도 보안관리가 가능하다.

## 5. Servlet 생명 주기
- init()
  
    초기화 단계에서 한 번만 수행된다.
  
    클라이언트(browser)의 요청에 따라 적절한 Servlet이 생성되고 이 Servlet이 메모리에 로드될 때 init() 메소드가 호출된다.


- service(request, response)
  
    응답에 대한 모든 내용은 service()에 구현해야 한다.
  
    Servlet이 수신한 모든 request에 대해 service() 메소드가 호출된다.
  
    service() 메소드는 request의 type(HTTP Method: GET, POST, PUT, DELETE 등)에 따라 적절한 메소드(doGet, doPost, doPut, doDelete 등)를 호출한다.
  
    즉, 하위 클래스에서 doGet, doPost 등의 메서드를 오버라이드해두면 HttpServlet의 service() 요청에 맞는 메소드(하위 클래스에서 오버라이드한 메소드)를 알아서 호출할 수 있게 되는 것이다.
    메소드가 실행되고나면 해당 쓰레드는 제거된다.


- destroy()
    
    Servlet 객체를 파괴해야할 때, 호출된다. 
  
    Web Application이 갱신되거나 WAS가 종료될 때 호출된다.

## 참고 
<https://gmlwjd9405.github.io/2018/10/28/servlet.html>